{% extends 'base.html' %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="fas fa-chart-pie"></i> Recruiter KPI Dashboard</h2>
        {% if session.role == 'Manager' %}
        <form class="d-flex" method="GET">
            <select name="agent_id" class="form-select me-2" onchange="this.form.submit()">
                <option value="{{ session.user_id }}">My Stats</option>
                {% for agent in agents %}
                <option value="{{ agent.UserID }}" {{ 'selected' if request.args.get('agent_id') == agent.UserID|string }}>
                    {{ agent.FullName }}
                </option>
                {% endfor %}
            </select>
        </form>
        {% endif %}
    </div>

    <div class="row g-4">
        <!-- Total Leads -->
        <div class="col-md-4">
            <div class="card shadow-sm border-start border-5 border-primary h-100">
                <div class="card-body">
                    <h6 class="text-uppercase text-muted fw-bold">Total Registered</h6>
                    <h1 class="display-4 fw-bold text-primary">{{ stats.total_leads }}</h1>
                    <small class="text-muted"><i class="fas fa-users"></i> All time candidates</small>
                </div>
            </div>
        </div>

        <!-- In Progress -->
        <div class="col-md-2">
            <div class="card shadow-sm border-start border-5 border-info h-100">
                <div class="card-body">
                    <h6 class="text-uppercase text-muted fw-bold" style="font-size: 0.8rem;">In Talent Test</h6>
                    <h3 class="fw-bold text-info">{{ stats.in_progress }}</h3>
                    <small class="text-muted" style="font-size: 0.75rem;">Scheduled</small>
                </div>
            </div>
        </div>

        <!-- Passed (Ready) -->
        <div class="col-md-2">
            <div class="card shadow-sm border-start border-5 border-success h-100">
                <div class="card-body">
                    <h6 class="text-uppercase text-muted fw-bold" style="font-size: 0.8rem;">Passed (Ready)</h6>
                    <h3 class="fw-bold text-success">{{ stats.passed_test }}</h3>
                    <small class="text-muted" style="font-size: 0.75rem;">Matching Pool</small>
                </div>
            </div>
        </div>

        <!-- Failed (Needs Training) -->
        <div class="col-md-2">
            <div class="card shadow-sm border-start border-5 border-warning h-100">
                <div class="card-body">
                    <h6 class="text-uppercase text-muted fw-bold" style="font-size: 0.8rem;">Training Needed</h6>
                    <h3 class="fw-bold text-warning">{{ stats.failed_test }}</h3>
                    <small class="text-muted" style="font-size: 0.75rem;">Sales Opp.</small>
                </div>
            </div>
        </div>

        <!-- Rejected -->
        <div class="col-md-2">
            <div class="card shadow-sm border-start border-5 border-danger h-100">
                <div class="card-body">
                    <h6 class="text-uppercase text-muted fw-bold" style="font-size: 0.8rem;">Rejected</h6>
                    <h3 class="fw-bold text-danger">{{ stats.rejected }}</h3>
                    <small class="text-muted" style="font-size: 0.75rem;">Disqualified</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Drill Down Placeholder -->
    <div class="mt-5">
        <h5 class="text-muted border-bottom pb-2"><i class="fas fa-table"></i> Detailed Reports</h5>
        <div class="alert alert-light border">
            <i class="fas fa-info-circle text-info"></i> Click on any card above to view the detailed list of candidates (Coming Soon).
        </div>
    </div>
</div>
{% endblock %}
