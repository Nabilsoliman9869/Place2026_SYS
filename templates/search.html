{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <!-- Search Box -->
        <div class="card shadow-sm mb-5">
            <div class="card-body p-4">
                <form action="{{ url_for('global_search') }}" method="GET" class="d-flex">
                    <input type="text" name="q" class="form-control form-control-lg me-2"
                        placeholder="بحث عن طالب (اسم/هاتف)، شركة، أو دورة..." value="{{ q }}" autofocus>
                    <button type="submit" class="btn btn-primary btn-lg"><i class="fas fa-search"></i> بحث</button>
                </form>
            </div>
        </div>

        {% if q %}
        <h4 class="mb-4 text-muted">نتائج البحث عن: "{{ q }}"</h4>

        <!-- Candidates Results -->
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-white text-primary fw-bold">
                <i class="fas fa-user-graduate"></i> الطلاب والمرشحين ({{ candidates|length }})
            </div>
            {% if candidates %}
            <div class="list-group list-group-flush">
                {% for c in candidates %}
                <a href="{{ url_for('candidate_profile', candidate_id=c.CandidateID) }}"
                    class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                    <div>
                        <strong>{{ c.FullName }}</strong>
                        <div class="small text-muted">{{ c.Phone }} | {{ c.Email }}</div>
                    </div>
                    <span class="badge bg-secondary">{{ c.Status }}</span>
                </a>
                {% endfor %}
            </div>
            {% else %}
            <div class="card-body text-muted text-center">لا توجد نتائج</div>
            {% endif %}
        </div>

        <!-- Clients Results -->
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-white text-success fw-bold">
                <i class="fas fa-building"></i> الشركات والعملاء ({{ clients|length }})
            </div>
            {% if clients %}
            <div class="list-group list-group-flush">
                {% for c in clients %}
                <a href="{{ url_for('corporate_finance', client_id=c.ClientID) }}"
                    class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                    <div>
                        <strong>{{ c.CompanyName }}</strong>
                        <div class="small text-muted">{{ c.ContactPerson }} | {{ c.Phone }}</div>
                    </div>
                    <i class="fas fa-arrow-left text-muted"></i>
                </a>
                {% endfor %}
            </div>
            {% else %}
            <div class="card-body text-muted text-center">لا توجد نتائج</div>
            {% endif %}
        </div>

        <!-- Batches Results -->
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-white text-warning fw-bold">
                <i class="fas fa-chalkboard"></i> المجموعات التدريبية ({{ batches|length }})
            </div>
            {% if batches %}
            <div class="list-group list-group-flush">
                {% for b in batches %}
                <a href="{{ url_for('batch_details', batch_id=b.BatchID) }}"
                    class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                    <div>
                        <strong>{{ b.BatchName }}</strong>
                        <div class="small text-muted">{{ b.CourseName }}</div>
                    </div>
                    <span class="badge bg-{{ 'success' if b.Status=='Active' else 'secondary' }}">{{ b.Status }}</span>
                </a>
                {% endfor %}
            </div>
            {% else %}
            <div class="card-body text-muted text-center">لا توجد نتائج</div>
            {% endif %}
        </div>

        {% endif %}
    </div>
</div>
{% endblock %}