{% extends 'base.html' %}

{% block content %}
<div class="container-fluid">
    
    <!-- Header: Central Command -->
    <div class="d-flex justify-content-between align-items-center mb-4 bg-white p-3 rounded shadow-sm border-start border-5 border-primary">
        <div>
            <h2 class="fw-bold mb-0 text-dark"><i class="fas fa-network-wired me-2 text-primary"></i> Central Command Center</h2>
            <p class="text-muted mb-0 small">Operational Dashboard & Role Impersonation</p>
        </div>
        <div>
            <span class="badge bg-dark p-2 fs-6">Logged in as: {{ session.get('role', 'Manager') }}</span>
        </div>
    </div>

    <div class="row g-4">
        
        <!-- SECTOR 1: RECRUITMENT (Blue) -->
        <div class="col-lg-5">
            <div class="card h-100 border-0 shadow-sm" style="border-top: 5px solid #0d6efd !important;">
                <div class="card-header bg-white py-3">
                    <h5 class="fw-bold text-primary mb-0"><i class="fas fa-briefcase me-2"></i> Recruitment Sector</h5>
                </div>
                <div class="card-body">
                    <!-- Workflow Flowchart Representation -->
                    <div class="d-flex flex-column gap-3">
                        
                        <!-- Level 1: Management -->
                        <div class="d-flex justify-content-center gap-2">
                            <a href="{{ url_for('recruitment_dashboard') }}" class="btn btn-outline-primary fw-bold w-100 py-3 position-relative">
                                <i class="fas fa-user-tie d-block fs-4 mb-2"></i> Account Manager
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                                    {{ stats.reqs }}
                                </span>
                            </a>
                            <a href="{{ url_for('recruitment_dashboard') }}" class="btn btn-outline-primary fw-bold w-100 py-3">
                                <i class="fas fa-tasks d-block fs-4 mb-2"></i> Allocation Mgr
                            </a>
                        </div>

                        <!-- Level 2: Operations -->
                        <div class="text-center text-muted"><i class="fas fa-arrow-down"></i></div>
                        
                        <div class="d-flex justify-content-center gap-2">
                             <a href="{{ url_for('recruitment_dashboard') }}" class="btn btn-outline-info w-100 py-2 text-dark">
                                <i class="fas fa-search-location me-2"></i> Allocation Specialist
                            </a>
                            <a href="{{ url_for('recruitment_dashboard') }}" class="btn btn-outline-info w-100 py-2 text-dark">
                                <i class="fas fa-users-cog me-2"></i> Recruitment Manager
                            </a>
                        </div>

                        <!-- Level 3: Execution -->
                        <div class="text-center text-muted"><i class="fas fa-arrow-down"></i></div>

                        <div class="d-flex justify-content-center gap-2">
                            <a href="{{ url_for('recruitment_dashboard') }}" class="btn btn-primary w-100 py-2">
                                <i class="fas fa-headset me-2"></i> Recruiter
                            </a>
                            <a href="{{ url_for('talent_dashboard') }}" class="btn btn-secondary w-100 py-2">
                                <i class="fas fa-clipboard-check me-2"></i> TA - Recruitment
                            </a>
                        </div>

                    </div>
                </div>
                <div class="card-footer bg-light">
                    <div class="row text-center small text-muted">
                        <div class="col"><strong>{{ stats.reqs }}</strong> Open Reqs</div>
                        <div class="col"><strong>{{ stats.candidates }}</strong> New Candidates</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTOR 2: TRAINING (Orange) -->
        <div class="col-lg-5">
            <div class="card h-100 border-0 shadow-sm" style="border-top: 5px solid #fd7e14 !important;">
                <div class="card-header bg-white py-3">
                    <h5 class="fw-bold text-warning mb-0" style="color: #fd7e14 !important;"><i class="fas fa-chalkboard-teacher me-2"></i> Training Sector</h5>
                </div>
                <div class="card-body">
                     <!-- Workflow Flowchart Representation -->
                     <div class="d-flex flex-column gap-3">
                        
                        <!-- Level 1: Management -->
                        <div class="d-flex justify-content-center">
                            <a href="{{ url_for('training_index') }}" class="btn btn-outline-warning text-dark fw-bold w-100 py-3 position-relative" style="border-color: #fd7e14;">
                                <i class="fas fa-graduation-cap d-block fs-4 mb-2"></i> Training & L&D Manager
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-success">
                                    {{ stats.batches }}
                                </span>
                            </a>
                        </div>

                        <!-- Level 2: Lead -->
                        <div class="text-center text-muted"><i class="fas fa-arrow-down"></i></div>
                        
                        <div class="d-flex justify-content-center gap-2">
                            <a href="{{ url_for('training_index') }}" class="btn btn-outline-warning text-dark w-100 py-2">
                                <i class="fas fa-layer-group me-2"></i> Training Lead
                            </a>
                            <a href="{{ url_for('training_index') }}" class="btn btn-outline-warning text-dark w-100 py-2">
                                <i class="fas fa-clipboard-list me-2"></i> Coordinator
                            </a>
                        </div>

                        <!-- Level 3: Execution -->
                        <div class="text-center text-muted"><i class="fas fa-arrow-down"></i></div>

                        <div class="d-flex justify-content-center gap-2">
                            <a href="{{ url_for('training_index') }}" class="btn btn-warning text-white w-100 py-2" style="background-color: #fd7e14;">
                                <i class="fas fa-chalkboard me-2"></i> Trainer
                            </a>
                            <a href="{{ url_for('talent_dashboard') }}" class="btn btn-secondary w-100 py-2">
                                <i class="fas fa-user-check me-2"></i> TA - Training
                            </a>
                            <a href="{{ url_for('sales_index') }}" class="btn btn-success w-100 py-2">
                                <i class="fas fa-dollar-sign me-2"></i> Sales
                            </a>
                        </div>

                    </div>
                </div>
                <div class="card-footer bg-light">
                    <div class="row text-center small text-muted">
                        <div class="col"><strong>{{ stats.batches }}</strong> Active Batches</div>
                        <div class="col"><strong>{{ stats.students }}</strong> Active Students</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SIDEBAR: SUMMARY DASHBOARDS -->
        <div class="col-lg-2">
            <div class="d-flex flex-column gap-3 h-100">
                
                <!-- Finance -->
                <div class="card border-0 shadow-sm bg-success text-white">
                    <div class="card-body p-3 text-center">
                        <h6 class="text-uppercase small mb-2">Finance</h6>
                        <h3 class="fw-bold mb-0">${{ stats.revenue }}</h3>
                        <a href="{{ url_for('finance_index') }}" class="stretched-link text-white small text-decoration-none">View Details</a>
                    </div>
                </div>

                <!-- Users -->
                <div class="card border-0 shadow-sm bg-dark text-white">
                    <div class="card-body p-3 text-center">
                        <h6 class="text-uppercase small mb-2">Users</h6>
                        <h3 class="fw-bold mb-0">{{ stats.users }}</h3>
                        <a href="{{ url_for('manage_users') }}" class="stretched-link text-white small text-decoration-none">Manage</a>
                    </div>
                </div>

                <!-- Shortcuts -->
                <div class="card border-0 shadow-sm flex-grow-1">
                    <div class="card-header bg-white fw-bold small">QUICK ACCESS</div>
                    <div class="list-group list-group-flush small">
                        <a href="{{ url_for('admin_import_candidates') }}" class="list-group-item list-group-item-action"><i class="fas fa-file-import me-2 text-primary"></i> Import Data</a>
                        <a href="{{ url_for('global_search') }}" class="list-group-item list-group-item-action"><i class="fas fa-search me-2 text-success"></i> Global Search</a>
                        <a href="#" class="list-group-item list-group-item-action text-muted"><i class="fas fa-chart-line me-2"></i> Reports (Soon)</a>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>
{% endblock %}
